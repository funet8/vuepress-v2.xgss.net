# Linux系统性能调优：CPU、内存、磁盘I/O等资源的优化策略

在进行性能调优前，**精准定位瓶颈**是关键 —— 盲目调整参数不仅无法解决问题，还可能引发新的系统风险。Linux 系统内置了多款轻量、高效的性能监控工具，通过这些工具可实时采集资源使用数据，为调优提供数据支撑。



## 一、CPU性能调优

### 1. 监控与分析

- 实时监控

  ```bash
  top        # 查看整体CPU占用
  htop       # 彩色交互式监控，支持按核查看
  mpstat 1   # 每秒输出一次CPU使用情况
  ```

- 定位高占用进程

  ```bash
  ps aux --sort=-%cpu | head -n 10
  ```

### 2. 常见问题

- 单线程任务占满一个核心
- 后台无关进程占用过多CPU
- CPU频率被节能策略限制

### 3. 优化策略

- 进程调度优化

  ```bash
  nice -n 10 <cmd>       # 降低优先级
  renice -n 15 -p <pid>  # 动态调整优先级
  taskset -c 0,1 <cmd>   # 绑定进程到指定CPU核
  ```

- 启用高性能模式

  ```bash
  echo performance | sudo tee /sys/devices/system/cpu/cpu*/cpufreq/scaling_governor
  ```

- 减少无用服务

  ```bash
  systemctl list-unit-files --state=enabled
  sudo systemctl disable <service>
  ```

------

## 二、内存性能调优

### 1. 监控与分析

- 查看内存使用

  ```bash
  free -h
  vmstat 1 5
  smem -r   # 按进程统计内存占用
  ```

- 检查Swap使用

  ```bash
  swapon --show
  ```

### 2. 常见问题

- 内存泄漏导致占用持续上升
- Swap频繁读写拖慢系统
- 缓存占用过多但未释放

### 3. 优化策略

- 释放缓存

  （谨慎使用）

  ```bash
  sync && echo 3 | sudo tee /proc/sys/vm/drop_caches
  ```

- 调整内核参数

  ```bash
  sysctl -w vm.swappiness=10          # 降低Swap使用倾向
  sysctl -w vm.overcommit_memory=1    # 允许内存超分配
  ```

- 升级硬件或优化应用

  - 增加物理内存
  - 使用 jemalloc / tcmalloc 优化分配效率

------

## 三、磁盘 I/O 性能调优

### 1. 监控与分析

- 实时I/O监控

  ```bash
  iotop
  iostat -dx 1 5
  ```

- 文件系统使用情况

  ```bash
  df -h
  du -sh /var/log/*
  ```

### 2. 常见问题

- 日志或数据库频繁写入导致I/O瓶颈
- 磁盘碎片化
- 文件系统参数不合理

### 3. 优化策略

- **使用SSD替代HDD** 提升随机读写性能

- 挂载参数优化

  ```bash
  sudo mount -o remount,noatime,nodiratime /dev/sda1 /
  ```

- 分离高I/O目录

  - 将 `/var/log`、数据库数据目录单独挂载到高速磁盘

- 启用异步I/O

  （数据库场景）

  ```ini
  # MySQL示例
  innodb_flush_log_at_trx_commit=2
  ```

------

## 四、综合调优建议

1. **持续监控**  
    使用 `top`、`htop`、`vmstat`、`iotop` 等工具形成日常巡检习惯。
2. 分层优化
   - 应用层：优化算法、减少无效计算
   - 系统层：调整调度策略、内核参数
   - 硬件层：升级CPU、内存、磁盘
3. 自动化与告警
   - 使用 `Prometheus + Grafana` 建立可视化监控与告警
4. 案例驱动优化
   - 先定位瓶颈，再针对性调优，避免盲目改动

好的，星哥，我帮你整理了一份 **Linux 性能调优命令速查表**，按 **CPU / 内存 / 磁盘 I/O / 网络 / 系统综合** 五大类分组，方便你在排查和优化时快速定位工具与用法。

------

## 🖥 CPU 调优命令

| 命令              | 用途                  | 示例                   |       |
| ----------------- | --------------------- | ---------------------- | ----- |
| `top` / `htop`    | 实时查看 CPU 占用     | `htop`                 |       |
| `mpstat`          | 按核统计 CPU 使用率   | `mpstat -P ALL 1`      |       |
| `ps`              | 查看高占用进程        | `ps aux --sort=-%cpu   | head` |
| `pidstat`         | 按进程统计 CPU 使用   | `pidstat -u 1`         |       |
| `taskset`         | 绑定进程到指定 CPU 核 | `taskset -c 0,1 <cmd>` |       |
| `nice` / `renice` | 调整进程优先级        | `renice -n 10 -p 1234` |       |

------

## 🧠 内存调优命令

| 命令            | 用途                 | 示例                         |
| --------------- | -------------------- | ---------------------------- |
| `free -h`       | 查看内存使用情况     | `free -h`                    |
| `vmstat`        | 内存/CPU/IO 综合监控 | `vmstat 1 5`                 |
| `smem`          | 按进程统计内存占用   | `smem -r`                    |
| `pmap`          | 查看进程内存映射     | `pmap -x <pid>`              |
| `swapon --show` | 查看 Swap 使用       | `swapon --show`              |
| `sysctl`        | 调整内核内存参数     | `sysctl -w vm.swappiness=10` |

------

## 💽 磁盘 I/O 调优命令

| 命令     | 用途                  | 示例                |            |
| -------- | --------------------- | ------------------- | ---------- |
| `iostat` | 查看磁盘 I/O 统计     | `iostat -dx 1 5`    |            |
| `iotop`  | 实时查看进程 I/O 占用 | `iotop`             |            |
| `df -h`  | 查看磁盘空间          | `df -h`             |            |
| `du -sh` | 查看目录大小          | `du -sh /var/log/*` |            |
| `lsblk`  | 查看磁盘分区信息      | `lsblk -f`          |            |
| `mount`  | 查看挂载参数          | `mount              | grep sda1` |

------

## 🌐 网络性能调优命令

| 命令         | 用途              | 示例                       |
| ------------ | ----------------- | -------------------------- |
| `iftop`      | 实时查看网络流量  | `iftop -i eth0`            |
| `nload`      | 网络流量监控      | `nload`                    |
| `ss`         | 查看连接状态      | `ss -tulnp`                |
| `ethtool`    | 查看/设置网卡参数 | `ethtool eth0`             |
| `ping`       | 网络连通性测试    | `ping -c 4 8.8.8.8`        |
| `traceroute` | 路由跟踪          | `traceroute www.baidu.com` |

------

## 🛠 系统综合调优命令

| 命令         | 用途             | 示例                          |
| ------------ | ---------------- | ----------------------------- |
| `uptime`     | 查看系统负载     | `uptime`                      |
| `sar`        | 系统资源历史统计 | `sar -u 1 5`                  |
| `dstat`      | 综合性能监控     | `dstat -tcmnd`                |
| `sysctl`     | 调整内核参数     | `sysctl -a`                   |
| `systemctl`  | 管理系统服务     | `systemctl disable <service>` |
| `journalctl` | 查看系统日志     | `journalctl -xe`              |

------

💡 **使用建议**

1. **先监控，后调优**：不要盲目修改内核参数，先用监控工具定位瓶颈。
2. **组合使用**：`vmstat` + `iostat` + `sar` 能快速判断 CPU / 内存 / I/O 谁是瓶颈。
3. **自动化巡检**：可用 `cron` 定时采集 `sar` 数据，长期分析趋势。

------



## 五、总结

Linux性能调优是一个 **持续监控 → 定位瓶颈 → 精准优化** 的闭环过程。
 通过合理利用工具、调整系统参数、优化硬件配置，可以显著提升系统的稳定性与响应速度。

