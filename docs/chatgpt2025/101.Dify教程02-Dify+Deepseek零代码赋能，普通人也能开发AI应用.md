---
title: 101.Difyæ•™ç¨‹02-Dify+Deepseeké›¶ä»£ç èµ‹èƒ½ï¼Œæ™®é€šäººä¹Ÿèƒ½å¼€å‘AIåº”ç”¨
createTime: 2025/05/27 17:51:17
permalink: /article/546xrwm5/
---
# Difyæ•™ç¨‹02 - Dify+Deepseeké›¶ä»£ç èµ‹èƒ½ï¼Œæ™®é€šäººä¹Ÿèƒ½å¼€å‘AIåº”ç”¨



å¼€å§‹ä»Šå¤©çš„æ•™ç¨‹ä¹‹å‰ï¼Œå…ˆè§£å†³æ˜¨å¤©é‡åˆ°çš„ä¸€ä¸ªé—®é¢˜ï¼Œdockerå®‰è£…Difyçš„æ—¶å€™æœ‰ä¸ªæŠ¥é”™ï¼Œè¿›å…¥Difyé¢æ¿çš„æ—¶å€™ä¼šå‡ºç°â€œInternal Server Errorâ€çš„æç¤ºï¼Œlogæ—¥å¿—æŠ¥é”™ï¼šS3_USE_AWS_MANAGED_IAM to S3UseAwsManagedIam: converting '' to type bool.ã€‚

![image-20250410194325010](https://imgoss.xgss.net/picgo/image-20250410194325010.png?aliyun)

## æŠ¥é”™

```
docker logs docker-plugin_daemon-1
å¦‚ä¸‹çš„æŠ¥é”™
goroutine 1 [running]:
github.com/langgenius/dify-plugin-daemon/internal/utils/log.writeLog({0x1857285, 0x5}, {0x1896127?, 0xc00016d408?}, 0x1, {0xc0004cdf28, 0x1, 0x1})
        /app/internal/utils/log/log.go:40 +0x305
github.com/langgenius/dify-plugin-daemon/internal/utils/log.Panic(...)
        /app/internal/utils/log/log.go:66
main.main()
        /app/cmd/server/main.go:19 +0x9f
2025/04/09 09:48:27 main.go:19: [PANIC]Error processing environment variables: envconfig.Process: assigning S3_USE_AWS_MANAGED_IAM to S3UseAwsManagedIam: converting '' to type bool. details: strconv.ParseBool: parsing "": invalid syntax
panic: [PANIC]Error processing environment variables: envconfig.Process: assigning S3_USE_AWS_MANAGED_IAM to S3UseAwsManagedIam: converting '' to type bool. details: strconv.ParseBool: parsing "": invalid syntax

goroutine 1 [running]:
github.com/langgenius/dify-plugin-daemon/internal/utils/log.writeLog({0x1857285, 0x5}, {0x1896127?, 0xc0001f8008?}, 0x1, {0xc00019df28, 0x1, 0x1})
        /app/internal/utils/log/log.go:40 +0x305
github.com/langgenius/dify-plugin-daemon/internal/utils/log.Panic(...)
        /app/internal/utils/log/log.go:66
main.main()
        /app/cmd/server/main.go:19 +0x9f
```

## è§£å†³æ–¹æ³•

è¿›å…¥ dify æºä»£ç çš„ docker ç›®å½•ï¼ŒæŒ‰é¡ºåºæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

```
vi .env
æŠŠä¸‹é¢ä¸‰è¡Œéƒ½åˆ æ‰ã€‚
S3_USE_AWS_MANAGED_IAM: ${PLUGIN_S3_USE_AWS_MANAGED_IAM:-}
S3_ENDPOINT: ${PLUGIN_S3_ENDPOINT:-}
S3_USE_PATH_STYLE: ${PLUGIN_S3_USE_PATH_STYLE:-}

å†é‡å¯docker
docker compose down
docker compose up -d

```

docker psæŸ¥çœ‹æ˜¯å¦è¿˜æœ‰æŠ¥é”™

```
docker ps
CONTAINER ID   IMAGE                                       COMMAND                  CREATED             STATUS                       PORTS                                                                      NAMES
8a02ec3bcbb7   langgenius/dify-plugin-daemon:0.0.7-local   "/bin/bash -c /app/eâ€¦"   About an hour ago   Up About an hour             0.0.0.0:5003->5003/tcp, :::5003->5003/tcp                                  docker-plugin_daemon-1
```

ç»ˆäºæ­£å¸¸äº†ï¼Œä¹Ÿä¸ä¼šæœ‰æŠ¥é”™äº†ã€‚

å®‰è£…å¥½äº†

## å‰æœŸå‡†å¤‡

1.æœ¬åœ°å®‰è£…ollamaæˆ–è€…è·å–åˆ°ç¬¬ä¸‰æ–¹çš„deepseekçš„æ¥å£

æœ¬åœ°å®‰è£…ollamaå¯ä»¥å‚è€ƒï¼šhttps://mp.weixin.qq.com/s/kJ7JCgFUNKWtPtp8r5mR_A

2.å®‰è£…Difyå¯ä»¥å‚è€ƒï¼šhttps://mp.weixin.qq.com/s/HYDBOXmkXGypGl3IpXqiCw

# Difyæ¨¡å‹è®¾ç½®

## 1. è®¿é—®Dify

æµè§ˆå™¨è¾“å…¥IPæˆ–è€…localhostï¼Œè®¿é—®Dify

![image-20250410191417927](https://imgoss.xgss.net/picgo/image-20250410191417927.png?aliyun)

è¾“å…¥è´¦å·å¯†ç ç™»å½•æˆåŠŸã€‚

## 2. æ·»åŠ æ¨¡å‹

ç‚¹å‡» Dify å¹³å°å³ä¸Šè§’å¤´åƒ

è®¾ç½®

ä»¥æ­¤ç‚¹å‡»ï¼š

è®¾ç½®

æ¨¡å‹ä¾›åº”å•†

é€‰æ‹© Ollama ï¼Œå¦‚æœæ²¡æœ‰å®‰è£…ç‚¹å‡»å®‰è£…ã€‚

æ·»åŠ æ¨¡å‹ã€‚

![image-20250410191748669](https://imgoss.xgss.net/picgo/image-20250410191748669.png?aliyun)

æŸ¥çœ‹æˆ‘çš„ollamaçš„å¤§æ¨¡å‹æœ‰å“ªäº›

```
C:\Users\Administrator>ollama list
NAME                       ID              SIZE      MODIFIED
deepseek-v2:16b            7c8c332f2df7    8.9 GB    13 days ago
nomic-embed-text:latest    0a109f422b47    274 MB    4 weeks ago
qwq:32b-q4_K_M             cc1091b0e276    19 GB     4 weeks ago
deepseek-r1:32b            38056bbcbb2d    19 GB     8 weeks ago
qwen2.5:14b                7cdf5a0187d5    9.0 GB    8 weeks ago
llama3-cn-8b:latest        d710bb08d58c    6.6 GB    2 months ago
llama2-chinese:latest      cee11d703eee    3.8 GB    2 months ago
deepseek-r1:14b            ea35dfe18182    9.0 GB    2 months ago
qwen2.5:latest             845dbda0ea48    4.7 GB    2 months ago
deepseek-r1:7b             0a8c26691023    4.7 GB    2 months ago
llama3:latest              365c0bd3c000    4.7 GB    2 months ago
```

æˆ‘è¿™é‡Œé€‰æ‹© deepseek-r1:7b

æ¨¡å‹åç§°å¡«å†™ï¼š deepseek-r1:7b

åŸºç¡€URLå¡«ï¼šhttp://192.168.1.18:11434 ï¼ˆå¦‚æœä½ çš„æœ¬æœºçš„ollama åˆ™å¯ä»¥å¡«å†™ï¼š http://host.docker.internal:11434 ï¼‰

å…¶ä»–å¯ä¿æŒé»˜è®¤ï¼Œç‚¹å‡»ä¿å­˜

![image-20250410192244214](https://imgoss.xgss.net/picgo/image-20250410192244214.png?aliyun)

## 3.åˆ›å»ºèŠå¤©åº”ç”¨

è¿”å›ä¸»é¡µï¼Œè¿›å…¥â€œå·¥ä½œå®¤-èŠå¤©åŠ©æ‰‹â€ï¼Œåˆ›å»ºç©ºç™½åº”ç”¨ã€‚

é€‰æ‹©èŠå¤©åŠ©æ‰‹

å¡«å†™åº”ç”¨åç§°ã€å›¾æ ‡ã€‚

![image-20250410192402907](https://imgoss.xgss.net/picgo/image-20250410192402907.png?aliyun)

ç‚¹å‡»â€œåˆ›å»ºâ€ã€‚

ç¼–æ’èŠå¤©åŠ©æ‰‹

æç¤ºè¯ï¼Œå˜é‡ã€çŸ¥è¯†åº“éƒ½å¯ä»¥æŒ‰ç…§å®é™…éœ€æ±‚å¡«å†™

ç‚¹å‡»å³ä¾§å‘å¸ƒã€‚

![image-20250410192940852](https://imgoss.xgss.net/picgo/image-20250410192940852.png?aliyun)

ç‚¹å‡»è¿è¡Œå¯ä»¥çœ‹åˆ°å®é™…æ•ˆæœ

![image-20250410193330064](https://imgoss.xgss.net/picgo/image-20250410193330064.png?aliyun)

åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬å°±å®Œæˆäº†ç¬¬ä¸€ä¸ªåº”ç”¨ï¼šèŠå¤©åŠ©æ‰‹ çš„æ­å»º

# ç»“å°¾

Difyä¸DeepSeekçš„æ·±åº¦é›†æˆï¼Œé€šè¿‡æœ¬æ–‡çš„ä»‹ç»å’Œæ¡ˆä¾‹åˆ†æï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œæ™®é€šäººå€ŸåŠ©Difyå’ŒDeepSeekï¼Œæ— éœ€æ·±åšçš„ç¼–ç¨‹åŸºç¡€ï¼Œå°±èƒ½è½»æ¾å¼€å‘å‡ºåŠŸèƒ½å¼ºå¤§çš„AIåº”ç”¨ã€‚

å†™æ–‡ä¸æ˜“ï¼Œå¦‚æœä½ éƒ½çœ‹åˆ°äº†è¿™é‡Œï¼Œè¯·ç‚¹ä¸ªèµå’Œåœ¨çœ‹ï¼Œåˆ†äº«ç»™æ›´å¤šçš„æœ‹å‹ï¼›ä¹Ÿåˆ«å¿˜äº†å…³æ³¨æ˜Ÿå“¥ç©äº‘ï¼è¿™é‡Œæœ‰æ»¡æ»¡çš„å¹²è´§åˆ†äº«ï¼Œè¿˜æœ‰è½»æ¾æœ‰è¶£çš„æŠ€æœ¯äº¤æµï½ç‚¹ä¸ªèµã€åˆ†äº«ç»™èº«è¾¹çš„å°ä¼™ä¼´ï¼Œä¸€èµ·æˆé•¿ï¼Œä¸€èµ·ç©è½¬æŠ€æœ¯ä¸–ç•Œå§ï¼ ğŸ˜Š