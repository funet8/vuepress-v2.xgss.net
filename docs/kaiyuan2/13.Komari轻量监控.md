# 再见zabbix！轻量级自建服务器监控神器在Linux 的完整部署指南

在日常运维中，服务器监控是绕不开的核心环节。相比笨重的 Zabbix、Prometheus，**Komari** 以轻量、自建、可控著称，尤其适合个人开发者和中小团队。它提供直观的 Web 界面，支持轻量级 Agent 数据采集，部署简单，资源占用极低。本文将带你在 **Rocky Linux** 上快速落地 Komari。

GitHub 项目地址：https://github.com/komari-monitor/komari

## Komari 的核心亮点

- **轻量高效**：Go 语言开发，资源占用极低。
- **自建可控**：数据完全掌握在自己手里，避免第三方泄露风险。
- **Web 界面**：开箱即用的可视化监控面板。
- **多种部署方式**：支持一键脚本、Docker、二进制文件。

![img](https://imgoss.xgss.net/picgo-tx2025/QQ_1762352246987.png?tx)

## Rocky Linux 环境准备

本次环境系统使用的是Rocky Linux9

1. **更新系统**

```bash
sudo dnf update -y
```

1. **安装必要工具**

```bash
sudo dnf install -y curl wget git
```

1. **开放防火墙端口（默认 25774）**

```bash
sudo firewall-cmd --permanent --add-port=25774/tcp
sudo firewall-cmd --reload
```

## 部署方式一：Docker 部署（推荐）

如果你习惯容器化，Docker 是更优雅的选择。

宝塔中部署docker

![img](https://imgoss.xgss.net/picgo-tx2025/QQ_1762350621012.png?tx)

```bash
# 安装 Docker（若未安装）
sudo dnf install -y dnf-plugins-core
sudo dnf config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo
sudo dnf install -y docker-ce docker-ce-cli containerd.io
sudo systemctl enable --now docker

# 创建数据目录
 mkdir -p /data/docker

# 启动容器
docker run -d \
  -p 25774:25774 \
  -v /data/docker/komari-data:/app/data \
  --name komari \
  ghcr.io/komari-monitor/komari:latest
```

![img](https://imgoss.xgss.net/picgo-tx2025/QQ_1762350756798.png?tx)

查看默认账号密码：

```bash
docker logs komari
```



## 部署方式二：一键安装脚本（推荐）

Komari 官方提供了安装脚本，适合快速体验。

```bash
curl -fsSL https://raw.githubusercontent.com/komari-monitor/komari/main/install-komari.sh -o install-komari.sh
chmod +x install-komari.sh
sudo ./install-komari.sh
```

安装完成后，访问：

```
http://<服务器IP>:25774
```

默认用户名和密码会在安装日志中显示，可通过环境变量 `ADMIN_USERNAME` 和 `ADMIN_PASSWORD` 自定义。



## 部署方式三：二进制文件

适合不想依赖容器的场景。

```bash
# 下载最新 release
wget https://github.com/komari-monitor/komari/releases/latest/download/komari-linux-amd64 -O komari
chmod +x komari

# 启动服务
./komari server -l 0.0.0.0:25774

# ./komari server -l 0.0.0.0:25774
2025/11/05 21:59:36 Komari Monitor 1.1.3 (hash: XXXXX)
2025/11/05 21:59:36 Using SQLite database file: ./data/komari.db
2025/11/05 13:59:36 Application timezone is set to 'UTC'.
2025/11/05 13:59:36 Default admin account created. Username: admin , Password: XXXXXXXXXXXXXXX
2025/11/05 13:59:36 Starting server on 0.0.0.0:25774 ...
2025/11/05 13:59:36 Using ipinfo.io as GeoIP provider.
```



## 访问与验证

浏览器打开：

```
http://<服务器IP>:25774
```

输入账号密码即可进入监控面板。此时你已经拥有一个轻量级、自建的服务器监控平台。

![img](https://imgoss.xgss.net/picgo-tx2025/QQ_1762351252350.png?tx)

### 登录监控后台

![img](https://imgoss.xgss.net/picgo-tx2025/QQ_1762351491374.png?tx)

### 添加节点

![img](https://imgoss.xgss.net/picgo-tx2025/QQ_1762351449237.png?tx)

再点击编辑

### 记住令牌

![img](https://imgoss.xgss.net/picgo-tx2025/QQ_1762351533381.png?tx)



## Nginx反向代理配置

安装nginx，省略

编辑 Nginx 配置文件：

```
vi /etc/nginx/conf.d/komari.conf
```

写入以下内容（假设 Komari 运行在本地 `25774` 端口）：

```
server {
    listen 80;
    server_name monitor.example.com;

    location / {
        proxy_pass http://127.0.0.1:25774;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
}
```

就可以使用域名访问komari

# Komari 客户端（Agent）安装指南

Komari 的客户端（Agent）需要安装在被监控的服务器或设备上，用于采集系统信息并上报到 Komari 主控端。安装方式主要有 **Linux 二进制安装**、**Docker 部署** 和 **Windows 安装（WinSW 托管）**  [komari-document.pages.dev](https://komari-document.pages.dev/install/quick-start) 

```
https://komari-document.pages.dev/install/quick-start
```



## 获取 Agent

- GitHub Releases 页面：https://github.com/komari-monitor/komari-agent/releases
- 根据目标系统选择对应版本：
  - Linux: `komari-agent-linux-amd64`
  - Windows: `komari-agent-windows-amd64.exe`
  - ARM 架构: `komari-agent-linux-arm64`

## Linux 客户端安装（推荐）

1. **下载并赋权**

```bash
wget https://github.com/komari-monitor/komari-agent/releases/latest/download/komari-agent-linux-amd64 -O komari-agent
chmod +x komari-agent
```

1. **运行 Agent**

```bash
./komari-agent -e http://<主控端地址>:25774 -t <注册Token>
```

- `-e` 指定 Komari 主控端地址
- `-t` 为主控端生成的注册 Token

1. **后台运行（systemd）**

```bash
vim /etc/systemd/system/komari-agent.service
```

写入：

```ini
[Unit]
Description=Komari Agent
After=network.target

[Service]
ExecStart=/usr/local/bin/komari-agent -e http://<主控端地址>:25774 -t <注册Token>
Restart=always

[Install]
WantedBy=multi-user.target
```

启用并启动：

```bash
sudo systemctl daemon-reload
sudo systemctl enable --now komari-agent
```



## Docker 部署 Agent

```bash
docker run -d \
  --name komari-agent \
  ghcr.io/komari-monitor/komari-agent:latest \
  -e http://<主控端地址>:25774 \
  -t <注册Token>
```



## Windows 客户端安装（WinSW 托管） 

1. 下载 `komari-agent-windows-amd64.exe`
2. 下载 [WinSW](https://github.com/winsw/winsw/releases/latest)，重命名为 `komari-agent.exe`
3. 在同目录下创建 `komari-agent.xml`，内容示例：

```xml
<service>
  <id>komari-agent</id>
  <name>Komari Agent</name>
  <description>Komari Windows Agent Service</description>
  <executable>komari-agent-windows-amd64.exe</executable>
  <arguments>-e http://<主控端地址>:25774 -t <注册Token></arguments>
</service>
```

1. 以管理员身份运行：

```powershell
komari-agent.exe install
komari-agent.exe start
```



## 验证

- 登录 Komari Web 控制台
- 在 **节点管理** 中确认客户端是否上线
- 若未上线，检查防火墙端口、Token 是否正确

![img](https://imgoss.xgss.net/picgo-tx2025/QQ_1762352001117.png?tx)



至此，你的 Komari 客户端已成功安装并接入主控端。

## 总结

如果你追求 **轻量、可控、快速部署** 的监控方案，Komari 是一个极具性价比的选择。无论是 **一键脚本** 还是 **Docker 部署**，都能在几分钟内完成落地。对于个人开发者和中小团队来说，它几乎是“零门槛”的监控神器。