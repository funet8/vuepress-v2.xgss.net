import{_ as e}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as a,a as n,o as i}from"./app-BiQR_lPj.js";const t={};function l(d,s){return i(),a("div",null,s[0]||(s[0]=[n(`<h1 id="自建私有云相册-docker一键部署immich-照片视频备份利器" tabindex="-1"><a class="header-anchor" href="#自建私有云相册-docker一键部署immich-照片视频备份利器"><span>自建私有云相册：Docker一键部署Immich，照片视频备份利器</span></a></h1><h1 id="前言" tabindex="-1"><a class="header-anchor" href="#前言"><span>前言</span></a></h1><p>随着人们手机、PC、平板等电子产品多样，我们拍摄和保存的照片和视频数量也在不断增加。如何高效地管理和备份这些珍贵的记忆成为了一个重要的问题。</p><p>传统的云备份虽然方便，但受限于云空间大小和隐私保护的问题。而私有云相册则成为了一个理想的解决方案，其中开源的Immich更是以其强大的功能和易用性脱颖而出。</p><p>今天星哥将介绍如何在云服务器或NAS上利用Docker一键部署Immich，打造一个属于自己的私有云相册。</p><h1 id="immich" tabindex="-1"><a class="header-anchor" href="#immich"><span>Immich</span></a></h1><p>Immich是一款基于开源技术的私有云相册管理工具，旨在提供快速、自动化的照片和视频备份功能。其特点包括：</p><p>开源地址：https://github.com/immich-app/immich 目前已有 55K+的star数量</p><p>官方地址：https://immich.app/</p><p><img src="https://imgoss.xgss.net/picgo/image-20241231154644994.png?aliyun" alt="image-20241231154644994"></p><h2 id="immich-私有云相册的一些特性" tabindex="-1"><a class="header-anchor" href="#immich-私有云相册的一些特性"><span>Immich 私有云相册的一些特性</span></a></h2><ul><li><strong>多平台支持</strong>：提供了移动端和 Web 网页端版本，可以在任何设备上随时访问相册。</li><li><strong>自动备份</strong>： 和 iCloud、谷歌相册 一样，Immich 支持后台自动备份照片和视频。</li><li><strong>选择性备份</strong>：支持备份指定的相册，而不必备份所有的照片和视频。</li><li><strong>高级搜索功能</strong>：用户可以根据元数据、对象、人脸等条件进行搜索，轻松找到照片。</li><li><strong>安全性</strong>： Immich 完全开源，且数据存储在你自己的服务器上。数据安全可控，同时还支持 OAuth 进行身份验证。</li><li><strong>多用户支持和分享</strong>： Immich 支持多用户，并允许用户创建<strong>共享相册</strong>，与朋友、家人或合作伙伴分享照片和视频。</li><li><strong>地理位置信息</strong>： 应用程序提供了地图视图，允许用户查看和浏览地理位置信息，以及在地图上查看媒体内容。</li><li><strong>人脸识别和聚合</strong>： Immich 可识别人脸并进行聚合，使用户能够更轻松地组织和查找他们的照片。</li><li><strong>离线支持</strong>： 移动端应用程序提供离线支持，允许在没有网络的情况下查看照片和视频。</li></ul><h2 id="功能特性" tabindex="-1"><a class="header-anchor" href="#功能特性"><span>功能特性</span></a></h2><table><thead><tr><th style="text-align:left;">特征</th><th style="text-align:left;">移动应用</th><th style="text-align:left;">网页</th></tr></thead><tbody><tr><td style="text-align:left;">上传和查看视频和照片</td><td style="text-align:left;">✅</td><td style="text-align:left;">✅</td></tr><tr><td style="text-align:left;">打开应用程序时自动备份</td><td style="text-align:left;">✅</td><td style="text-align:left;">❌</td></tr><tr><td style="text-align:left;">用于备份的选择性相册</td><td style="text-align:left;">✅</td><td style="text-align:left;">❌</td></tr><tr><td style="text-align:left;">将照片和视频下载到本地设备</td><td style="text-align:left;">✅</td><td style="text-align:left;">✅</td></tr><tr><td style="text-align:left;">多用户支持</td><td style="text-align:left;">✅</td><td style="text-align:left;">✅</td></tr><tr><td style="text-align:left;">相册和共享相簿</td><td style="text-align:left;">✅</td><td style="text-align:left;">✅</td></tr><tr><td style="text-align:left;">可擦洗/可拖动的滚动条</td><td style="text-align:left;">✅</td><td style="text-align:left;">✅</td></tr><tr><td style="text-align:left;">支持RAW（HEIC，HEIF，DNG，APPLE ProRaw）</td><td style="text-align:left;">✅</td><td style="text-align:left;">✅</td></tr><tr><td style="text-align:left;">元数据视图（EXIF、地图）</td><td style="text-align:left;">✅</td><td style="text-align:left;">✅</td></tr><tr><td style="text-align:left;">按元数据、对象和图像标签搜索</td><td style="text-align:left;">✅</td><td style="text-align:left;">❌</td></tr><tr><td style="text-align:left;">管理功能（用户管理）</td><td style="text-align:left;">❌</td><td style="text-align:left;">✅</td></tr><tr><td style="text-align:left;">后台备份</td><td style="text-align:left;">✅</td><td style="text-align:left;">❌</td></tr><tr><td style="text-align:left;">虚拟滚动</td><td style="text-align:left;">✅</td><td style="text-align:left;">✅</td></tr><tr><td style="text-align:left;">OAuth 支持</td><td style="text-align:left;">✅</td><td style="text-align:left;">✅</td></tr><tr><td style="text-align:left;">实时照片备份和播放</td><td style="text-align:left;">iOS</td><td style="text-align:left;">✅</td></tr><tr><td style="text-align:left;">用户自定义存储结构</td><td style="text-align:left;">✅</td><td style="text-align:left;">✅</td></tr><tr><td style="text-align:left;">公开分享</td><td style="text-align:left;">❌</td><td style="text-align:left;">✅</td></tr></tbody></table><h2 id="备份功能" tabindex="-1"><a class="header-anchor" href="#备份功能"><span>备份功能</span></a></h2><p>配置好服务器端，登录移动应用之后，给于相册权限，就可以备份了，支持前台备份与后台备份，使用起来非常简单，有中文界面</p><h1 id="准备工作" tabindex="-1"><a class="header-anchor" href="#准备工作"><span>准备工作</span></a></h1><ul><li>云服务器、NAS、虚拟机等等（必须，云服务器：http://y.xgss.net/aliyun 或 https://y.xgss.net/tx）</li><li>已安装Docker或Docker Compose，如果不会看看我之前的教程，或者参考官方文档。</li><li>域名（非必须）</li></ul><h1 id="docker-compose安装-immich" tabindex="-1"><a class="header-anchor" href="#docker-compose安装-immich"><span>Docker-compose安装 Immich</span></a></h1><h2 id="_1-安装docker-和-docker-compose" tabindex="-1"><a class="header-anchor" href="#_1-安装docker-和-docker-compose"><span>1.安装Docker 和 Docker-compose</span></a></h2><p>省略</p><h2 id="_2-下载-env文件" tabindex="-1"><a class="header-anchor" href="#_2-下载-env文件"><span>2.下载.env文件</span></a></h2><p>安装 Immich 很容易，先修改配置文件 .env：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>mkdir -p /data/docker/immich</span></span>
<span class="line"><span></span></span>
<span class="line"><span>cd  /data/docker/immich</span></span>
<span class="line"><span></span></span>
<span class="line"><span>wget -O .env https://github.com/immich-app/immich/releases/latest/download/example.env</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>查看文件</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>  cat .env</span></span>
<span class="line"><span># You can find documentation for all the supported env variables at https://immich.app/docs/install/environment-variables</span></span>
<span class="line"><span></span></span>
<span class="line"><span># The location where your uploaded files are stored</span></span>
<span class="line"><span>UPLOAD_LOCATION=./library</span></span>
<span class="line"><span># The location where your database files are stored</span></span>
<span class="line"><span>DB_DATA_LOCATION=./postgres</span></span>
<span class="line"><span></span></span>
<span class="line"><span># To set a timezone, uncomment the next line and change Etc/UTC to a TZ identifier from this list: https://en.wikipedia.org/wiki/List_of_tz_database_time_zones#List</span></span>
<span class="line"><span># TZ=Etc/UTC</span></span>
<span class="line"><span>TZ=Asia/Shanghai</span></span>
<span class="line"><span></span></span>
<span class="line"><span># The Immich version to use. You can pin this to a specific version like &quot;v1.71.0&quot;</span></span>
<span class="line"><span>IMMICH_VERSION=release</span></span>
<span class="line"><span></span></span>
<span class="line"><span># Connection secret for postgres. You should change it to a random password</span></span>
<span class="line"><span># Please use only the characters \`A-Za-z0-9\`, without special characters or spaces</span></span>
<span class="line"><span>DB_PASSWORD=postgres</span></span>
<span class="line"><span></span></span>
<span class="line"><span># The values below this line do not need to be changed</span></span>
<span class="line"><span>###################################################################################</span></span>
<span class="line"><span>DB_USERNAME=postgres</span></span>
<span class="line"><span>DB_DATABASE_NAME=immich</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>把时区改成上海</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span># TZ=Etc/UTC</span></span>
<span class="line"><span>改成</span></span>
<span class="line"><span>TZ=Asia/Shanghai</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>实际上，只需要修改里面的 UPLOAD_LOCATION 部分，使用绝对路径，这是保存照片的路径。</p><p>其它设置保持默认，然后就可以安装了：</p><h2 id="_3-下载docker-compose-yml运行" tabindex="-1"><a class="header-anchor" href="#_3-下载docker-compose-yml运行"><span>3.下载docker-compose.yml运行</span></a></h2><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>wget https://github.com/immich-app/immich/releases/latest/download/docker-compose.yml</span></span>
<span class="line"><span></span></span>
<span class="line"><span>docker-compose up -d</span></span>
<span class="line"><span></span></span>
<span class="line"><span>docker-compose down # 关闭</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>查看运行状态</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>docker ps</span></span>
<span class="line"><span>CONTAINER ID   IMAGE                                                COMMAND                  CREATED              STATUS                        PORTS                    NAMES</span></span>
<span class="line"><span>8afd5060a34b   ghcr.io/immich-app/immich-server:release             &quot;tini -- /bin/bash s…&quot;   About a minute ago   Up About a minute (healthy)   0.0.0.0:2283-&gt;2283/tcp   immich_server</span></span>
<span class="line"><span>e8a54115e963   redis:6.2-alpine                                     &quot;docker-entrypoint.s…&quot;   About a minute ago   Up About a minute (healthy)   6379/tcp                 immich_redis</span></span>
<span class="line"><span>e7ccc41993ba   tensorchord/pgvecto-rs:pg14-v0.2.0                   &quot;docker-entrypoint.s…&quot;   About a minute ago   Up About a minute (healthy)   5432/tcp                 immich_postgres</span></span>
<span class="line"><span>ec4d59c06e34   ghcr.io/immich-app/immich-machine-learning:release   &quot;tini -- ./start.sh&quot;     About a minute ago   Up About a minute (healthy)                            immich_machine_learning</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_4-浏览器打开" tabindex="-1"><a class="header-anchor" href="#_4-浏览器打开"><span>4.浏览器打开</span></a></h2><p>在浏览器打开：<code>IP:2283</code> 就可以创建用户进入 Immich 了。</p><p><img src="https://imgoss.xgss.net/picgo/image-20241231161436485.png?aliyun" alt="image-20241231161436485"></p><h2 id="设置管理员账号" tabindex="-1"><a class="header-anchor" href="#设置管理员账号"><span>设置管理员账号</span></a></h2><p><img src="https://imgoss.xgss.net/picgo/image-20241231161550071.png?aliyun" alt="image-20241231161550071"></p><h1 id="下载客户端" tabindex="-1"><a class="header-anchor" href="#下载客户端"><span>下载客户端</span></a></h1><p>Immich 的官方 App</p><ul><li><a href="https://apps.apple.com/us/app/immich/id1613945652" target="_blank" rel="noopener noreferrer">Apple App Store</a></li><li><a href="https://f-droid.org/packages/app.alextran.immich" target="_blank" rel="noopener noreferrer">F-Droid</a></li><li><a href="https://github.com/immich-app/immich/releases" target="_blank" rel="noopener noreferrer">GitHub Releases (apk)</a></li></ul><h1 id="nginx配置-可选" tabindex="-1"><a class="header-anchor" href="#nginx配置-可选"><span>Nginx配置（可选）</span></a></h1><h2 id="_1-配置https" tabindex="-1"><a class="header-anchor" href="#_1-配置https"><span>1. 配置HTTPS</span></a></h2><p>为了提升安全性，可以通过反向代理（如NGINX）配置HTTPS。以下是一个基本配置示例：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>server {</span></span>
<span class="line"><span>    listen 443 ssl;</span></span>
<span class="line"><span>    server_name yourdomain.com;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    ssl_certificate /path/to/cert.pem;</span></span>
<span class="line"><span>    ssl_certificate_key /path/to/key.pem;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    location / {</span></span>
<span class="line"><span>        proxy_pass http://127.0.0.1:2283;</span></span>
<span class="line"><span>        proxy_set_header Host $host;</span></span>
<span class="line"><span>        proxy_set_header X-Real-IP $remote_addr;</span></span>
<span class="line"><span>        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_2-数据备份" tabindex="-1"><a class="header-anchor" href="#_2-数据备份"><span>2. 数据备份</span></a></h2><p>为防止数据丢失，建议定期备份数据库和存储文件夹。</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>备份：library 和 postgres 文件夹。</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h1 id="总结" tabindex="-1"><a class="header-anchor" href="#总结"><span>总结</span></a></h1><p>通过Docker一键部署Immich，您可以快速搭建一个功能强大、隐私安全的私有云相册。无论是家庭日常记录，还是旅行照片备份，Immich都能满足您的需求。如果您对数据隐私和存储控制有较高要求，不妨尝试一下！</p>`,51)]))}const c=e(t,[["render",l]]),h=JSON.parse('{"path":"/article/6uxxg105/","title":"immich","lang":"en-US","frontmatter":{"title":"immich","createTime":"2025/05/27 17:51:17","permalink":"/article/6uxxg105/"},"git":{"createdTime":1749111496000,"updatedTime":1750129445000,"contributors":[{"name":"star","username":"star","email":"star@xgss.net","commits":2,"url":"https://github.com/star"}]},"readingTime":{"minutes":4.87,"words":1461},"filePathRelative":"kaiyuan/photo/immich.md"}');export{c as comp,h as data};
