import{_ as n}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as a,a as i,o as e}from"./app-BiQR_lPj.js";const l={};function p(d,s){return e(),a("div",null,s[0]||(s[0]=[i(`<h1 id="ç©è½¬rocky-linux-9-éƒ¨ç½²redisæŒ‡å—" tabindex="-1"><a class="header-anchor" href="#ç©è½¬rocky-linux-9-éƒ¨ç½²redisæŒ‡å—"><span>ç©è½¬Rocky Linux 9 éƒ¨ç½²RedisæŒ‡å—</span></a></h1><p>å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯æ˜Ÿå“¥ã€‚ä»Šå¤©ï¼Œå’±ä»¬æ¥ç›˜ä¸€ç›˜Redisï¼ŒRedisä½œä¸ºé«˜æ€§èƒ½çš„é”®å€¼æ•°æ®åº“ï¼Œåœ¨ç¼“å­˜ã€æ¶ˆæ¯é˜Ÿåˆ—ã€å®æ—¶æ•°æ®å¤„ç†ç­‰åœºæ™¯ä¸­æ‰®æ¼”ç€ä¸¾è¶³è½»é‡çš„è§’è‰²ã€‚</p><h1 id="åŠŸèƒ½ä»‹ç»" tabindex="-1"><a class="header-anchor" href="#åŠŸèƒ½ä»‹ç»"><span>åŠŸèƒ½ä»‹ç»</span></a></h1><p>åŠŸèƒ½ä»‹ç»ï¼šRocky Linux 9ç³»ç»Ÿä¸­æºç åŒ…å®‰è£… Redis çš„shellè„šæœ¬</p><p>å®‰è£…ç‰ˆæœ¬ï¼šredis-7.4.1</p><p>ç«¯å£ï¼š63920</p><p>é…ç½®æ‰€åœ¨çš„ç›®å½•ï¼š /data/conf/</p><p>å¯†ç ï¼š YpassWord666 ã€è¯·ä¿®æ”¹å¯†ç ã€‘</p><p>redisæŒä¹…åŒ–ç›®å½•ï¼š/data/redis/ç«¯å£å·</p><p>redisæ—¥å¿—ï¼š /data/redis/ç«¯å£å·/redis_ç«¯å£å·.log</p><p><img src="https://imgoss.xgss.net/picgo-tx2025/QQ_1753085468878.png?tx" alt="img"></p><h2 id="å¿«é€Ÿå®‰è£…" tabindex="-1"><a class="header-anchor" href="#å¿«é€Ÿå®‰è£…"><span>å¿«é€Ÿå®‰è£…</span></a></h2><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>ä½¿ç”¨ï¼š</span></span>
<span class="line"><span>gitee:</span></span>
<span class="line"><span>wget https://gitee.com/funet8/Rocky-Linux-Shell/raw/main/shell/Rocky_Linux_9_Install_Redis.sh</span></span>
<span class="line"><span>sh Rocky_Linux_9_Install_Redis.sh</span></span>
<span class="line"><span></span></span>
<span class="line"><span>github:</span></span>
<span class="line"><span>wget https://raw.githubusercontent.com/funet8/Rocky-Linux-Shell/refs/heads/main/shell/Rocky_Linux_9_Install_Redis.sh</span></span>
<span class="line"><span>sh Rocky_Linux_9_Install_Redis.sh</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_1-å®‰è£…ä¾è€" tabindex="-1"><a class="header-anchor" href="#_1-å®‰è£…ä¾è€"><span>1.å®‰è£…ä¾è€</span></a></h2><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>dnf groupinstall  -y &quot;Development Tools&quot;</span></span>
<span class="line"><span>dnf install -y gcc jemalloc-devel tcl</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_2-æ–°å»ºç›®å½•" tabindex="-1"><a class="header-anchor" href="#_2-æ–°å»ºç›®å½•"><span>2.æ–°å»ºç›®å½•</span></a></h2><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>mkdir -p /data/software/</span></span>
<span class="line"><span>mkdir -p /data/conf/</span></span>
<span class="line"><span>cd /data/software/</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_3-ä¸‹è½½å®‰è£…åŒ…" tabindex="-1"><a class="header-anchor" href="#_3-ä¸‹è½½å®‰è£…åŒ…"><span>3.ä¸‹è½½å®‰è£…åŒ…</span></a></h2><p>è§£å‹å¹¶å®‰è£…</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span></span></span>
<span class="line"><span># å»è¿™é‡ŒæŸ¥æ‰¾ http://download.redis.io/releases/</span></span>
<span class="line"><span># å®˜æ–¹ä¸‹è½½åœ°å€ï¼š</span></span>
<span class="line"><span>wget http://download.redis.io/releases/redis-7.4.1.tar.gz</span></span>
<span class="line"><span>tar -zxf redis-7.4.1.tar.gz</span></span>
<span class="line"><span>cd redis-7.4.1</span></span>
<span class="line"><span>make</span></span>
<span class="line"><span>cd src &amp;&amp; make test</span></span>
<span class="line"><span>make install</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_4-é…ç½®redis" tabindex="-1"><a class="header-anchor" href="#_4-é…ç½®redis"><span>4.é…ç½®redis</span></a></h2><h3 id="å¼€æœºå¯åŠ¨æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#å¼€æœºå¯åŠ¨æ–‡ä»¶"><span>å¼€æœºå¯åŠ¨æ–‡ä»¶</span></a></h3><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>mkdir /etc/init.d/</span></span>
<span class="line"><span>cp /data/software/redis-7.4.1/utils/redis_init_script /etc/init.d/redis_63920</span></span>
<span class="line"><span>#ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼š</span></span>
<span class="line"><span>sed -i &quot;s/REDISPORT\\=6379/REDISPORT\\=63920/g&quot; /etc/init.d/redis_63920</span></span>
<span class="line"><span>sed -i &quot;s/\\/etc\\/redis\\//\\/data\\/conf\\//g&quot; /etc/init.d/redis_63920</span></span>
<span class="line"><span></span></span>
<span class="line"><span>å¯åŠ¨redisã€å¼€æœºè‡ªå¯åŠ¨</span></span>
<span class="line"><span>/etc/init.d/redis_63920 start</span></span>
<span class="line"><span>echo &quot;/etc/init.d/redis_63920 start&quot; &gt;&gt; /etc/rc.d/rc.local</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="é…ç½®æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#é…ç½®æ–‡ä»¶"><span>é…ç½®æ–‡ä»¶</span></a></h3><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>#åˆ›å»ºç›®å½•</span></span>
<span class="line"><span>mkdir -p /data/conf/</span></span>
<span class="line"><span>cp /data/software/redis-7.4.1/redis.conf  /data/conf/63920.conf</span></span>
<span class="line"><span></span></span>
<span class="line"><span>cat &gt; /data/conf/63920.conf &lt;&lt; EOFI</span></span>
<span class="line"><span>#ç»‘å®šçš„ä¸»æœºåœ°å€ï¼Œé»˜è®¤ï¼šbind 127.0.0.1</span></span>
<span class="line"><span>bind 0.0.0.0</span></span>
<span class="line"><span>#ç«¯å£</span></span>
<span class="line"><span>port 63920</span></span>
<span class="line"><span># TCP ç›‘å¬çš„æœ€å¤§å®¹çº³æ•°é‡</span></span>
<span class="line"><span># åœ¨é«˜å¹¶å‘çš„ç¯å¢ƒä¸‹ï¼Œä½ éœ€è¦æŠŠè¿™ä¸ªå€¼è°ƒé«˜ä»¥é¿å…å®¢æˆ·ç«¯è¿æ¥ç¼“æ…¢çš„é—®é¢˜ã€‚</span></span>
<span class="line"><span># Linux å†…æ ¸ä¼šä¸€å£°ä¸å“çš„æŠŠè¿™ä¸ªå€¼ç¼©å°æˆ /proc/sys/net/core/somaxconn å¯¹åº”çš„å€¼ï¼Œ</span></span>
<span class="line"><span># æ‰€ä»¥ä½ è¦ä¿®æ”¹è¿™ä¸¤ä¸ªå€¼æ‰èƒ½è¾¾åˆ°ä½ çš„é¢„æœŸã€‚</span></span>
<span class="line"><span>tcp-backlog 511</span></span>
<span class="line"><span># æŒ‡å®šåœ¨ä¸€ä¸ª client ç©ºé—²å¤šå°‘ç§’ä¹‹åå…³é—­è¿æ¥ï¼ˆ0 å°±æ˜¯ä¸ç®¡å®ƒï¼‰</span></span>
<span class="line"><span>timeout 20</span></span>
<span class="line"><span># tcp å¿ƒè·³åŒ…ã€‚</span></span>
<span class="line"><span># å¦‚æœè®¾ç½®ä¸ºéé›¶ï¼Œåˆ™åœ¨ä¸å®¢æˆ·ç«¯ç¼ºä¹é€šè®¯çš„æ—¶å€™ä½¿ç”¨ SO_KEEPALIVE å‘é€ tcp acks ç»™å®¢æˆ·ç«¯ã€‚</span></span>
<span class="line"><span># è¿™ä¸ªä¹‹æ‰€æœ‰æœ‰ç”¨ï¼Œä¸»è¦ç”±ä¸¤ä¸ªåŸå› ï¼š</span></span>
<span class="line"><span># 1) é˜²æ­¢æ­»çš„ peers</span></span>
<span class="line"><span># 2) Take the connection alive from the point of view of network</span></span>
<span class="line"><span>#    equipment in the middle.</span></span>
<span class="line"><span># æ¨èä¸€ä¸ªåˆç†çš„å€¼å°±æ˜¯60ç§’</span></span>
<span class="line"><span>tcp-keepalive 60</span></span>
<span class="line"><span># é»˜è®¤æƒ…å†µä¸‹ redis ä¸æ˜¯ä½œä¸ºå®ˆæŠ¤è¿›ç¨‹è¿è¡Œçš„ï¼Œå¦‚æœä½ æƒ³è®©å®ƒåœ¨åå°è¿è¡Œï¼Œä½ å°±æŠŠå®ƒæ”¹æˆ yesã€‚</span></span>
<span class="line"><span># å½“redisä½œä¸ºå®ˆæŠ¤è¿›ç¨‹è¿è¡Œçš„æ—¶å€™ï¼Œå®ƒä¼šå†™ä¸€ä¸ª pid åˆ° /var/run/redis.pid æ–‡ä»¶é‡Œé¢ã€‚</span></span>
<span class="line"><span>daemonize yes</span></span>
<span class="line"><span>#å¯ä»¥é€šè¿‡upstartå’Œsystemdç®¡ç†Rediså®ˆæŠ¤è¿›ç¨‹ï¼Œè¿™ä¸ªå‚æ•°æ˜¯å’Œå…·ä½“çš„æ“ä½œç³»ç»Ÿç›¸å…³çš„ã€‚</span></span>
<span class="line"><span>supervised no</span></span>
<span class="line"><span>#å½“redisä»¥å®ˆæŠ¤æ¨¡å¼å¯åŠ¨æ—¶æŒ‡å®špid</span></span>
<span class="line"><span>pidfile /var/run/redis_63920.pid</span></span>
<span class="line"><span>#loglevelæ—¥å¿—çº§åˆ«</span></span>
<span class="line"><span>#debug--&gt;è®°å½•å¤§é‡æ—¥å¿—ä¿¡æ¯ï¼Œé€‚ç”¨äºå¼€å‘ã€æµ‹è¯•é˜¶æ®µ</span></span>
<span class="line"><span>#verbose--&gt;è¾ƒå¤šæ—¥å¿—ä¿¡æ¯</span></span>
<span class="line"><span>#notice--&gt;é€‚é‡æ—¥å¿—ä¿¡æ¯ï¼Œä½¿ç”¨äºç”Ÿäº§ç¯å¢ƒ</span></span>
<span class="line"><span>#warning--&gt;ä»…æœ‰éƒ¨åˆ†é‡è¦ã€å…³é”®ä¿¡æ¯æ‰ä¼šè¢«è®°å½•</span></span>
<span class="line"><span>loglevel notice</span></span>
<span class="line"><span>#æ—¥å¿—æ–‡ä»¶çš„ä½ç½® </span></span>
<span class="line"><span>logfile &quot;/data/conf/redis_63920.log&quot;</span></span>
<span class="line"><span>#è®¾ç½®æ•°æ®åº“çš„æ•°ç›®</span></span>
<span class="line"><span>databases 16</span></span>
<span class="line"><span>#ä¿å­˜æ•°æ®åˆ°ç£ç›˜ã€‚æ ¼å¼æ˜¯ï¼šsave &lt;seconds&gt; &lt;changes&gt; ï¼Œå«ä¹‰æ˜¯åœ¨ seconds ç§’ä¹‹åè‡³å°‘æœ‰ changesä¸ªkeys å‘ç”Ÿæ”¹å˜åˆ™ä¿å­˜ä¸€æ¬¡ã€‚</span></span>
<span class="line"><span>#é»˜è®¤è®¾ç½®æ„æ€æ˜¯ï¼šåœ¨60 ç§’ä¹‹å†…æœ‰10000 ä¸ªkeys å‘ç”Ÿå˜åŒ–æ—¶ã€åœ¨300 ç§’ä¹‹å†…æœ‰10 ä¸ªkeys å‘ç”Ÿäº†å˜åŒ–ã€åœ¨900 ç§’ä¹‹å†…æœ‰1 ä¸ªkeys å‘ç”Ÿäº†å˜åŒ–ï¼Œåˆ™é•œåƒå¤‡ä»½ã€‚</span></span>
<span class="line"><span>save 900 1</span></span>
<span class="line"><span>save 300 10</span></span>
<span class="line"><span>save 60 10000</span></span>
<span class="line"><span>#é»˜è®¤æƒ…å†µä¸‹ï¼Œå¦‚æœ redis æœ€åä¸€æ¬¡çš„åå°ä¿å­˜å¤±è´¥ï¼Œredis å°†åœæ­¢æ¥å—å†™æ“ä½œï¼Œè¿™æ ·ä»¥ä¸€ç§å¼ºç¡¬çš„æ–¹å¼è®©ç”¨æˆ·çŸ¥é“æ•°æ®ä¸èƒ½æ­£ç¡®çš„æŒä¹…åŒ–åˆ°ç£ç›˜ï¼Œ å¦åˆ™å°±ä¼šæ²¡äººæ³¨æ„åˆ°ç¾éš¾çš„å‘ç”Ÿã€‚ å¦‚æœåå°ä¿å­˜è¿›ç¨‹é‡æ–°å¯åŠ¨å·¥ä½œäº†ï¼Œredis ä¹Ÿå°†è‡ªåŠ¨çš„å…è®¸å†™æ“ä½œã€‚ç„¶è€Œä½ è¦æ˜¯å®‰è£…äº†é è°±çš„ç›‘æ§ï¼Œä½ å¯èƒ½ä¸å¸Œæœ› redis è¿™æ ·åšï¼Œé‚£ä½ å°±æ”¹æˆ no å¥½äº†ã€‚</span></span>
<span class="line"><span>stop-writes-on-bgsave-error yes</span></span>
<span class="line"><span>#æ˜¯å¦åœ¨dump  .rdbæ•°æ®åº“çš„æ—¶å€™å‹ç¼©å­—ç¬¦ä¸²ï¼Œé»˜è®¤è®¾ç½®ä¸ºyesã€‚å¦‚æœä½ æƒ³èŠ‚çº¦ä¸€äº›cpuèµ„æºçš„è¯ï¼Œå¯ä»¥æŠŠå®ƒè®¾ç½®ä¸ºnoï¼Œè¿™æ ·çš„è¯æ•°æ®é›†å°±å¯èƒ½ä¼šæ¯”è¾ƒå¤§ã€‚</span></span>
<span class="line"><span>rdbcompression yes</span></span>
<span class="line"><span>#æ˜¯å¦CRC64æ ¡éªŒrdbæ–‡ä»¶ï¼Œä¼šæœ‰ä¸€å®šçš„æ€§èƒ½æŸå¤±ï¼ˆå¤§æ¦‚10%ï¼‰ã€‚</span></span>
<span class="line"><span>rdbchecksum yes</span></span>
<span class="line"><span>#rdbæ–‡ä»¶</span></span>
<span class="line"><span>dbfilename dump.rdb</span></span>
<span class="line"><span>#æ•°æ®åº“å­˜æ”¾ç›®å½•ã€‚å¿…é¡»æ˜¯ä¸€ä¸ªç›®å½•ï¼Œaofæ–‡ä»¶ä¹Ÿä¼šä¿å­˜åˆ°è¯¥ç›®å½•ä¸‹ã€‚</span></span>
<span class="line"><span>dir /data/conf/</span></span>
<span class="line"><span>#è®¾ç½®æœ¬æœºä¸ºslaveæœåŠ¡ã€‚æ ¼å¼ï¼šslaveof &lt;masterip&gt; &lt;masterport&gt;ã€‚è®¾ç½®masteræœåŠ¡çš„IPåœ°å€åŠç«¯å£ï¼Œåœ¨Rediså¯åŠ¨æ—¶ï¼Œå®ƒä¼šè‡ªåŠ¨ä»masterè¿›è¡Œæ•°æ®åŒæ­¥</span></span>
<span class="line"><span># slaveof  192.168.1.3  6379</span></span>
<span class="line"><span># slaveof &lt;masterip&gt; &lt;masterport&gt;</span></span>
<span class="line"><span>#å½“masteræœåŠ¡è®¾ç½®äº†å¯†ç ä¿æŠ¤æ—¶ï¼ŒslaveæœåŠ¡è¿æ¥masterçš„å¯†ç ã€‚</span></span>
<span class="line"><span>#masterauth</span></span>
<span class="line"><span>#å½“ä¸€ä¸ªslaveä¸masterå¤±å»è”ç³»æ—¶ï¼Œæˆ–è€…å¤åˆ¶æ­£åœ¨è¿›è¡Œçš„æ—¶å€™ï¼Œslaveåº”å¯¹è¯·æ±‚çš„è¡Œä¸ºï¼š1) å¦‚æœä¸º yesï¼ˆé»˜è®¤å€¼ï¼‰ ï¼Œslave ä»ç„¶ä¼šåº”ç­”å®¢æˆ·ç«¯è¯·æ±‚ï¼Œä½†è¿”å›çš„æ•°æ®å¯èƒ½æ˜¯è¿‡æ—¶ï¼Œæˆ–è€…æ•°æ®å¯èƒ½æ˜¯ç©ºçš„åœ¨ç¬¬ä¸€æ¬¡åŒæ­¥çš„æ—¶å€™ï¼›2) å¦‚æœä¸º no ï¼Œåœ¨ä½ æ‰§è¡Œé™¤äº† info å’Œ salveof ä¹‹å¤–çš„å…¶ä»–å‘½ä»¤æ—¶ï¼Œslave éƒ½å°†è¿”å›ä¸€ä¸ª &quot;SYNC with master in progress&quot; çš„é”™è¯¯ã€‚</span></span>
<span class="line"><span>slave-serve-stale-data yes</span></span>
<span class="line"><span>#è®¾ç½®slaveæ˜¯å¦æ˜¯åªè¯»çš„ã€‚ä»2.6ç‰ˆèµ·ï¼Œslaveé»˜è®¤æ˜¯åªè¯»çš„ã€‚</span></span>
<span class="line"><span>slave-read-only yes</span></span>
<span class="line"><span>#ä¸»ä»æ•°æ®å¤åˆ¶æ˜¯å¦ä½¿ç”¨æ— ç¡¬ç›˜å¤åˆ¶åŠŸèƒ½ã€‚</span></span>
<span class="line"><span>repl-diskless-sync no</span></span>
<span class="line"><span>repl-diskless-sync-delay 5</span></span>
<span class="line"><span>#æŒ‡å®šå‘slaveåŒæ­¥æ•°æ®æ—¶ï¼Œæ˜¯å¦ç¦ç”¨socketçš„NO_DELAYé€‰ é¡¹ã€‚è‹¥é…ç½®ä¸ºâ€œyesâ€ï¼Œåˆ™ç¦ç”¨NO_DELAYï¼Œåˆ™TCPåè®®æ ˆä¼šåˆå¹¶å°åŒ…ç»Ÿä¸€å‘é€ï¼Œè¿™æ ·å¯ä»¥å‡å°‘ä¸»ä»èŠ‚ç‚¹é—´çš„åŒ…æ•°é‡å¹¶èŠ‚çœå¸¦å®½ï¼Œä½†ä¼šå¢åŠ æ•°æ®åŒæ­¥åˆ° slaveçš„æ—¶é—´ã€‚è‹¥é…ç½®ä¸ºâ€œnoâ€ï¼Œè¡¨æ˜å¯ç”¨NO_DELAYï¼Œåˆ™TCPåè®®æ ˆä¸ä¼šå»¶è¿Ÿå°åŒ…çš„å‘é€æ—¶æœºï¼Œè¿™æ ·æ•°æ®åŒæ­¥çš„å»¶æ—¶ä¼šå‡å°‘ï¼Œä½†éœ€è¦æ›´å¤§çš„å¸¦å®½ã€‚ é€šå¸¸æƒ…å†µä¸‹ï¼Œåº”è¯¥é…ç½®ä¸ºnoä»¥é™ä½åŒæ­¥å»¶æ—¶ï¼Œä½†åœ¨ä¸»ä»èŠ‚ç‚¹é—´ç½‘ç»œè´Ÿè½½å·²ç»å¾ˆé«˜çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥é…ç½®ä¸ºyesã€‚</span></span>
<span class="line"><span>repl-disable-tcp-nodelay yes</span></span>
<span class="line"><span>#å½“ master ä¸èƒ½æ­£å¸¸å·¥ä½œçš„æ—¶å€™ï¼ŒRedis Sentinel ä¼šä» slaves ä¸­é€‰å‡ºä¸€ä¸ªæ–°çš„ masterï¼Œè¿™ä¸ªå€¼è¶Šå°ï¼Œå°±è¶Šä¼šè¢«ä¼˜å…ˆé€‰ä¸­ï¼Œä½†æ˜¯å¦‚æœæ˜¯ 0 ï¼Œ é‚£æ˜¯æ„å‘³ç€è¿™ä¸ª slave ä¸å¯èƒ½è¢«é€‰ä¸­ã€‚ é»˜è®¤ä¼˜å…ˆçº§ä¸º 100ã€‚</span></span>
<span class="line"><span>slave-priority 100</span></span>
<span class="line"><span>#è®¾ç½®redisè¿æ¥å¯†ç ã€‚</span></span>
<span class="line"><span>requirepass YpassWord666</span></span>
<span class="line"><span>#æ˜¯å¦å¯ç”¨aofæŒä¹…åŒ–æ–¹å¼ ã€‚å³æ˜¯å¦åœ¨æ¯æ¬¡æ›´æ–°æ“ä½œåè¿›è¡Œæ—¥å¿—è®°å½•ï¼Œé»˜è®¤é…ç½®æ˜¯noï¼Œå³åœ¨é‡‡ç”¨å¼‚æ­¥æ–¹å¼æŠŠæ•°æ®å†™å…¥åˆ°ç£ç›˜ï¼Œå¦‚æœä¸å¼€å¯ï¼Œå¯èƒ½ä¼šåœ¨æ–­ç”µæ—¶å¯¼è‡´éƒ¨åˆ†æ•°æ®ä¸¢å¤±ã€‚</span></span>
<span class="line"><span>appendonly no</span></span>
<span class="line"><span>#æ›´æ–°æ—¥å¿—æ–‡ä»¶åï¼Œé»˜è®¤å€¼ä¸ºappendonly.aof ã€‚</span></span>
<span class="line"><span>appendfilename &quot;appendonly.aof&quot;</span></span>
<span class="line"><span>#aofæ–‡ä»¶åˆ·æ–°çš„é¢‘ç‡ã€‚æœ‰ä¸‰ç§ï¼š</span></span>
<span class="line"><span>#no ä¾é OSè¿›è¡Œåˆ·æ–°ï¼Œredisä¸ä¸»åŠ¨åˆ·æ–°AOFï¼Œè¿™æ ·æœ€å¿«ï¼Œä½†å®‰å…¨æ€§å°±å·®ã€‚</span></span>
<span class="line"><span>#always æ¯æäº¤ä¸€ä¸ªä¿®æ”¹å‘½ä»¤éƒ½è°ƒç”¨fsyncåˆ·æ–°åˆ°AOFæ–‡ä»¶ï¼Œéå¸¸éå¸¸æ…¢ï¼Œä½†ä¹Ÿéå¸¸å®‰å…¨ã€‚</span></span>
<span class="line"><span>#everysec æ¯ç§’é’Ÿéƒ½è°ƒç”¨fsyncåˆ·æ–°åˆ°AOFæ–‡ä»¶ï¼Œå¾ˆå¿«ï¼Œä½†å¯èƒ½ä¼šä¸¢å¤±ä¸€ç§’ä»¥å†…çš„æ•°æ®ã€‚</span></span>
<span class="line"><span>appendfsync everysec</span></span>
<span class="line"><span>#æŒ‡å®šæ˜¯å¦åœ¨åå°aofæ–‡ä»¶rewriteæœŸé—´è°ƒç”¨fsyncï¼Œé»˜è®¤ä¸ºnoï¼Œè¡¨ç¤ºè¦è°ƒç”¨fsyncï¼ˆæ— è®ºåå°æ˜¯å¦æœ‰å­è¿›ç¨‹åœ¨åˆ·ç›˜ï¼‰ã€‚Redisåœ¨åå°å†™RDBæ–‡ä»¶æˆ–é‡å†™AOFæ–‡ä»¶æœŸé—´ä¼šå­˜åœ¨å¤§é‡ç£ç›˜IOï¼Œæ­¤æ—¶ï¼Œåœ¨æŸäº›linuxç³»ç»Ÿä¸­ï¼Œè°ƒç”¨fsyncå¯èƒ½ä¼šé˜»å¡ã€‚</span></span>
<span class="line"><span>no-appendfsync-on-rewrite no</span></span>
<span class="line"><span>#å½“AOFæ–‡ä»¶å¢é•¿åˆ°ä¸€å®šå¤§å°çš„æ—¶å€™Redisèƒ½å¤Ÿè°ƒç”¨ BGREWRITEAOF å¯¹æ—¥å¿—æ–‡ä»¶è¿›è¡Œé‡å†™ ã€‚å½“AOFæ–‡ä»¶å¤§å°çš„å¢é•¿ç‡å¤§äºè¯¥é…ç½®é¡¹æ—¶è‡ªåŠ¨å¼€å¯é‡å†™ã€‚</span></span>
<span class="line"><span>auto-aof-rewrite-percentage 100</span></span>
<span class="line"><span>#å½“AOFæ–‡ä»¶å¢é•¿åˆ°ä¸€å®šå¤§å°çš„æ—¶å€™Redisèƒ½å¤Ÿè°ƒç”¨ BGREWRITEAOF å¯¹æ—¥å¿—æ–‡ä»¶è¿›è¡Œé‡å†™ ã€‚å½“AOFæ–‡ä»¶å¤§å°å¤§äºè¯¥é…ç½®é¡¹æ—¶è‡ªåŠ¨å¼€å¯é‡å†™ã€‚</span></span>
<span class="line"><span>auto-aof-rewrite-min-size 64mb</span></span>
<span class="line"><span>#redisåœ¨å¯åŠ¨æ—¶å¯ä»¥åŠ è½½è¢«æˆªæ–­çš„AOFæ–‡ä»¶ï¼Œè€Œä¸éœ€è¦å…ˆæ‰§è¡Œ redis-check-aof å·¥å…·ã€‚</span></span>
<span class="line"><span>aof-load-truncated yes</span></span>
<span class="line"><span>#ä¸€ä¸ªLuaè„šæœ¬æœ€é•¿çš„æ‰§è¡Œæ—¶é—´ï¼Œå•ä½ä¸ºæ¯«ç§’ï¼Œå¦‚æœä¸º0æˆ–è´Ÿæ•°è¡¨ç¤ºæ— é™æ‰§è¡Œæ—¶é—´ï¼Œé»˜è®¤ä¸º5000ã€‚</span></span>
<span class="line"><span>lua-time-limit 5000</span></span>
<span class="line"><span>#è®¾å®šæ‰§è¡Œæ—¶é—´ï¼Œå•ä½æ˜¯æ¯«ç§’ï¼Œæ‰§è¡Œæ—¶é•¿è¶…è¿‡è¯¥æ—¶é—´çš„å‘½ä»¤å°†ä¼šè¢«è®°å…¥logã€‚-1è¡¨ç¤ºä¸è®°å½•slow log; 0å¼ºåˆ¶è®°å½•æ‰€æœ‰å‘½ä»¤</span></span>
<span class="line"><span>slowlog-log-slower-than 10000</span></span>
<span class="line"><span>#slow logçš„é•¿åº¦ã€‚æœ€å°å€¼ä¸º0ã€‚å¦‚æœæ—¥å¿—é˜Ÿåˆ—å·²è¶…å‡ºæœ€å¤§é•¿åº¦ï¼Œåˆ™æœ€æ—©çš„è®°å½•ä¼šè¢«ä»é˜Ÿåˆ—ä¸­æ¸…é™¤ã€‚ </span></span>
<span class="line"><span>slowlog-max-len 128</span></span>
<span class="line"><span>#æœåŠ¡ç«¯å†…éƒ¨çš„å»¶è¿Ÿç›‘æ§,è®¾ç½®ä¸€ä¸ªåˆç†çš„é˜ˆå€¼ï¼Œå¦‚è®¾ç½®100ms</span></span>
<span class="line"><span>latency-monitor-threshold 0</span></span>
<span class="line"><span>notify-keyspace-events &quot;&quot;</span></span>
<span class="line"><span>hash-max-ziplist-entries 512</span></span>
<span class="line"><span>hash-max-ziplist-value 64</span></span>
<span class="line"><span>list-max-ziplist-size -2</span></span>
<span class="line"><span>list-compress-depth 0</span></span>
<span class="line"><span>set-max-intset-entries 512</span></span>
<span class="line"><span>zset-max-ziplist-entries 128</span></span>
<span class="line"><span>zset-max-ziplist-value 64</span></span>
<span class="line"><span>hll-sparse-max-bytes 3000</span></span>
<span class="line"><span>activerehashing yes</span></span>
<span class="line"><span>client-output-buffer-limit normal 0 0 0</span></span>
<span class="line"><span>client-output-buffer-limit slave 256mb 64mb 60</span></span>
<span class="line"><span>client-output-buffer-limit pubsub 32mb 8mb 60</span></span>
<span class="line"><span>hz 10</span></span>
<span class="line"><span>aof-rewrite-incremental-fsync yes</span></span>
<span class="line"><span>#æœ€å¤§å†…å­˜è®¾ç½®ï¼Œé»˜è®¤ä¸º0,è¡¨ç¤º&quot;æ— é™åˆ¶&quot;,æ¨èä¸ºç‰©ç†å†…å­˜çš„3/4,æ­¤é…ç½®éœ€è¦å’Œ&quot;maxmemory-policy&quot;é…åˆä½¿ç”¨,å½“redisä¸­å†…å­˜æ•°æ®è¾¾åˆ°maxmemoryæ—¶,è§¦å‘&quot;æ¸…é™¤ç­–ç•¥&quot;</span></span>
<span class="line"><span>maxmemory 1024mb</span></span>
<span class="line"><span>#å†…å­˜ä¸è¶³&quot;æ—¶,æ•°æ®æ¸…é™¤ç­–ç•¥,é»˜è®¤ä¸º&quot;volatile-lru&quot;ã€‚</span></span>
<span class="line"><span>maxmemory-policy volatile-lru</span></span>
<span class="line"><span>#é™åˆ¶åŒæ—¶è¿æ¥çš„å®¢æˆ·ç«¯æ•°é‡ï¼Œä¸æ˜“è¿‡å¤§å…·ä½“å¤šå°‘æ ¹æ®å…·ä½“æƒ…å†µè€Œå®š</span></span>
<span class="line"><span>maxclients 30000</span></span>
<span class="line"><span>EOFI</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_5-é˜²ç«å¢™æ”¾å¼€ç«¯å£" tabindex="-1"><a class="header-anchor" href="#_5-é˜²ç«å¢™æ”¾å¼€ç«¯å£"><span>5.é˜²ç«å¢™æ”¾å¼€ç«¯å£</span></a></h2><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>###############4.é˜²ç«å¢™å¼€å¯ç«¯å£</span></span>
<span class="line"><span>#å…è®¸ç«¯å£</span></span>
<span class="line"><span>firewall-cmd --zone=public --add-port=63920/tcp --permanent</span></span>
<span class="line"><span>firewall-cmd --reload</span></span>
<span class="line"><span>firewall-cmd --zone=public --list-ports</span></span>
<span class="line"><span></span></span>
<span class="line"><span># æŸ¥çœ‹redisç‰ˆæœ¬</span></span>
<span class="line"><span>redis-cli --version</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_6-è¿æ¥redis" tabindex="-1"><a class="header-anchor" href="#_6-è¿æ¥redis"><span>6.è¿æ¥redis</span></a></h2><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>redis-cli -h IPåœ°å€ -p ç«¯å£ -a å¯†ç </span></span>
<span class="line"><span>ä¾‹å¦‚ï¼š</span></span>
<span class="line"><span>redis-cli -h 127.0.0.1 -p 63920 -a YpassWord666</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å…³é—­redis</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span># å…³é—­redis</span></span>
<span class="line"><span>redis-cli -h IPåœ°å€ -p ç«¯å£ -a å¯†ç  shutdown</span></span>
<span class="line"><span></span></span>
<span class="line"><span>ä¾‹å¦‚ï¼š</span></span>
<span class="line"><span>redis-cli -h 127.0.0.1 -p 63920 -a YpassWord666 shutdown</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è‡³æ­¤ï¼Œç°åœ¨ä½ å·²ç»åœ¨Rocky Linux 9ä¸ŠæˆåŠŸå®‰è£…å¹¶é…ç½®äº†Redisã€‚</p><h1 id="æœ€å" tabindex="-1"><a class="header-anchor" href="#æœ€å"><span>æœ€å</span></a></h1><p>å†™æ–‡ä¸æ˜“ï¼Œå¦‚æœä½ éƒ½çœ‹åˆ°äº†è¿™é‡Œï¼Œè¯·ç‚¹ä¸ªèµå’Œåœ¨çœ‹ï¼Œåˆ†äº«ç»™æ›´å¤šçš„æœ‹å‹ï¼›ä¹Ÿåˆ«å¿˜äº†å…³æ³¨æ˜Ÿå“¥ç©äº‘ï¼è¿™é‡Œæœ‰æ»¡æ»¡çš„å¹²è´§åˆ†äº«ï¼Œè¿˜æœ‰è½»æ¾æœ‰è¶£çš„æŠ€æœ¯äº¤æµï½ç‚¹ä¸ªèµã€åˆ†äº«ç»™èº«è¾¹çš„å°ä¼™ä¼´ï¼Œä¸€èµ·æˆé•¿ï¼Œä¸€èµ·ç©è½¬æŠ€æœ¯ä¸–ç•Œå§ï¼ ğŸ˜Š</p>`,34)]))}const v=n(l,[["render",p]]),t=JSON.parse('{"path":"/Rocky-Linux/11.Rocky-Linux-9-%E5%AE%89%E8%A3%85Redis.html","title":"ç©è½¬Rocky Linux 9 éƒ¨ç½²RedisæŒ‡å—","lang":"en-US","frontmatter":{},"git":{"createdTime":1754468658000,"updatedTime":1754468658000,"contributors":[{"name":"star","username":"star","email":"star@xgss.net","commits":1,"url":"https://github.com/star"}]},"readingTime":{"minutes":8.31,"words":2494},"filePathRelative":"Rocky-Linux/11.Rocky-Linux-9-å®‰è£…Redis.md"}');export{v as comp,t as data};
