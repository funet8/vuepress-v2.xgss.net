import{_ as s}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as n,a as e,o as i}from"./app-BiQR_lPj.js";const l={};function t(p,a){return i(),n("div",null,a[0]||(a[0]=[e(`<h1 id="apollo多环境以及集群配置-本地测试服务器" tabindex="-1"><a class="header-anchor" href="#apollo多环境以及集群配置-本地测试服务器"><span>Apollo多环境以及集群配置-本地测试服务器</span></a></h1><h2 id="一-前言" tabindex="-1"><a class="header-anchor" href="#一-前言"><span>一. 前言</span></a></h2><p>基于Linux搭建开源配置管理中心后，本篇文档是Apollo的多环境以及集群配置</p><h2 id="二-环境和准备" tabindex="-1"><a class="header-anchor" href="#二-环境和准备"><span>二. 环境和准备</span></a></h2><p>还是上文中的虚拟机基本配置：java8，apollo 1.9等</p><h3 id="apollo相关节点" tabindex="-1"><a class="header-anchor" href="#apollo相关节点"><span>apollo相关节点</span></a></h3><table><thead><tr><th style="text-align:center;">环境</th><th style="text-align:center;">地址</th><th style="text-align:center;">服务名</th></tr></thead><tbody><tr><td style="text-align:center;">后台</td><td style="text-align:center;">192.168.1.3:8070</td><td style="text-align:center;">apollo-portal</td></tr><tr><td style="text-align:center;">DEV</td><td style="text-align:center;">192.168.1.3:8080<br>192.168.1.3:8090</td><td style="text-align:center;">apollo-configservice<br>apollo-adminservice</td></tr><tr><td style="text-align:center;">PRO</td><td style="text-align:center;">192.168.1.2:8081<br>192.168.1.2:8091</td><td style="text-align:center;">apollo-configservice<br>apollo-adminservice</td></tr></tbody></table><h3 id="数据库配置" tabindex="-1"><a class="header-anchor" href="#数据库配置"><span>数据库配置：</span></a></h3><table><thead><tr><th style="text-align:center;">环境</th><th style="text-align:center;">地址</th><th style="text-align:center;">数据库名称</th></tr></thead><tbody><tr><td style="text-align:center;">后台</td><td style="text-align:center;">192.168.1.10:61920</td><td style="text-align:center;">ApolloPortalDB</td></tr><tr><td style="text-align:center;">DEV</td><td style="text-align:center;">192.168.1.10:61920</td><td style="text-align:center;">ApolloConfigDB</td></tr><tr><td style="text-align:center;">PRO</td><td style="text-align:center;">192.168.1.10:61920</td><td style="text-align:center;">ApolloConfigDBPro</td></tr></tbody></table><h2 id="三-修改相关配置" tabindex="-1"><a class="header-anchor" href="#三-修改相关配置"><span>三. 修改相关配置</span></a></h2><p>添加portal数据库相关环境配置</p><p>在ApolloPortalDB数据库的ServerConfig表中，添加字段 apollo.portal.envs 添加 dev,pro。</p><p><img src="https://imgoss.xgss.net/picgo/image-20220413154755350.png?aliyun" alt="image-20220413154755350"></p><p>添加portal相关meta相关配置</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>vi /data/wwwroot/web/apollo-1.9.2-github/apollo-portal-1.9.2-github/config/apollo-env.properties</span></span>
<span class="line"><span></span></span>
<span class="line"><span>dev.meta=http://192.168.1.3:8080</span></span>
<span class="line"><span>pro.meta=http://192.168.1.3:8081</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>其他环境的<strong>config</strong>服务和<strong>admin</strong>服务注意修改对应数据库连接。</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>cd /data/wwwroot/web/apollo-1.9.2-github</span></span>
<span class="line"><span>mkdir pro</span></span>
<span class="line"><span>cp -a apollo-adminservice-1.9.2-github pro/</span></span>
<span class="line"><span>cp -a apollo-configservice-1.9.2-github/ pro/</span></span>
<span class="line"><span>cd pro</span></span>
<span class="line"><span></span></span>
<span class="line"><span>vi /data/wwwroot/web/apollo-1.9.2-github/pro/apollo-adminservice-1.9.2-github/config/application-github.properties </span></span>
<span class="line"><span>将 ApolloConfigDB 改为 ApolloConfigDBPro</span></span>
<span class="line"><span>vi /data/wwwroot/web/apollo-1.9.2-github/pro/apollo-adminservice-1.9.2-github/config/app.properties</span></span>
<span class="line"><span>将 appId=100003172 改成  appId=100003175</span></span>
<span class="line"><span></span></span>
<span class="line"><span>vi /data/wwwroot/web/apollo-1.9.2-github/pro/apollo-adminservice-1.9.2-github/scripts/startup.sh</span></span>
<span class="line"><span>将端口8090 改为 8091 </span></span>
<span class="line"><span>LOG_DIR=/opt/logs/100003175</span></span>
<span class="line"><span>启动</span></span>
<span class="line"><span></span></span>
<span class="line"><span># vi /data/wwwroot/web/apollo-1.9.2-github/pro/apollo-configservice-1.9.2-github/config/application-github.properties </span></span>
<span class="line"><span>将 ApolloConfigDB 改为 ApolloConfigDBPro</span></span>
<span class="line"><span># vi /home/data/wwwroot/web/apollo-1.9.2-github/pro/apollo-configservice-1.9.2-github/config/app.properties</span></span>
<span class="line"><span>appId=100003172 改成 appId=100003176</span></span>
<span class="line"><span># vi /home/data/wwwroot/web/apollo-1.9.2-github/pro/apollo-configservice-1.9.2-github/</span></span>
<span class="line"><span>LOG_DIR=/opt/logs/100003172</span></span>
<span class="line"><span>## Adjust server port if necessary</span></span>
<span class="line"><span>SERVER_PORT=\${SERVER_PORT:=8081}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>启动pro服务</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>sh  /home/data/wwwroot/web/apollo-1.9.2-github/pro/apollo-configservice-1.9.2-github/scripts/startup.sh</span></span>
<span class="line"><span></span></span>
<span class="line"><span>sh  /home/data/wwwroot/web/apollo-1.9.2-github/pro/apollo-adminservice-1.9.2-github/scripts/startup.sh</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>https://blog.csdn.net/weixin_41133233/article/details/121833878</p>`,20)]))}const d=s(l,[["render",t]]),c=JSON.parse('{"path":"/article/oalffytf/","title":"1.Apollo多环境以及集群配置-本地测试","lang":"en-US","frontmatter":{"title":"1.Apollo多环境以及集群配置-本地测试","createTime":"2025/05/27 17:51:17","permalink":"/article/oalffytf/"},"git":{"createdTime":1749111496000,"updatedTime":1750129445000,"contributors":[{"name":"star","username":"star","email":"star@xgss.net","commits":2,"url":"https://github.com/star"}]},"readingTime":{"minutes":1.29,"words":388},"filePathRelative":"kaiyuan/Open-Source-Software/1.Apollo多环境以及集群配置-本地测试.md"}');export{d as comp,c as data};
