import{_ as a}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as e,a as n,o as i}from"./app-BiQR_lPj.js";const r={};function l(p,s){return i(),e("div",null,s[0]||(s[0]=[n(`<h1 id="群晖nas配置之zerotier实现内网穿透" tabindex="-1"><a class="header-anchor" href="#群晖nas配置之zerotier实现内网穿透"><span>群晖NAS配置之ZeroTier实现内网穿透</span></a></h1><h1 id="前言-内网穿透" tabindex="-1"><a class="header-anchor" href="#前言-内网穿透"><span>前言-内网穿透</span></a></h1><p>内网穿透是指通过一种技术让外部网络可以访问到内网的NAS设备，这样即使在不同网络环境下，也能够远程访问和管理NAS设备。以下是一些常见的内网穿透方案：</p><h2 id="synology官方提供的quickconnect" tabindex="-1"><a class="header-anchor" href="#synology官方提供的quickconnect"><span>Synology官方提供的QuickConnect</span></a></h2><p>Synology官方提供了QuickConnect服务，可以通过Synology账号远程访问NAS设备。用户可以在NAS控制面板中设置和管理QuickConnect服务，使其在不同网络环境下访问NAS变得更加简单。</p><h2 id="synology的ddns服务" tabindex="-1"><a class="header-anchor" href="#synology的ddns服务"><span>Synology的DDNS服务</span></a></h2><p>Synology NAS支持使用DDNS（动态域名解析）服务，可以为NAS设备设置一个动态域名，使用户可以通过域名访问NAS，而不必担心动态IP地址变化带来的问题。</p><h2 id="vpn-虚拟专用网络" tabindex="-1"><a class="header-anchor" href="#vpn-虚拟专用网络"><span>VPN（虚拟专用网络）</span></a></h2><p>通过在路由器上设置VPN服务器，或者使用NAS自身的VPN服务，可以建立安全的远程连接，让用户远程访问内网资源，包括NAS设备。</p><h2 id="端口转发-端口映射" tabindex="-1"><a class="header-anchor" href="#端口转发-端口映射"><span>端口转发/端口映射</span></a></h2><p>在路由器上设置端口转发（或称端口映射），将指定端口的流量转发到NAS设备上，这样用户就可以通过特定端口来访问NAS。但要确保端口转发时考虑到安全性，避免暴露不必要的服务或端口。</p><h2 id="第三方内网穿透服务" tabindex="-1"><a class="header-anchor" href="#第三方内网穿透服务"><span>第三方内网穿透服务</span></a></h2><p>使用类似于ngrok、frp、ZeroTier等第三方工具或服务进行内网穿透，这些服务可以帮助用户将内网设备暴露到公网上，但需要注意安全性和隐私保护。</p><p>这篇文章就来介绍ZeroTier实现内网穿透，ZeroTier异地组网是一个非常不错的内网穿透方式，特点就是免费，不限流。</p><p>缺点是免费用户只有25个</p><p><img src="https://imgoss.xgss.net/picgo/zerotier-pic.jpg?aliyun" alt="zerotier-pic"></p><h1 id="步骤" tabindex="-1"><a class="header-anchor" href="#步骤"><span>步骤</span></a></h1><ol><li><p>注册ZeroTier账号</p></li><li><p>群晖Nas中配置ZeroTier</p></li><li><p>安装ZeroTier客户端</p></li></ol><h1 id="注册zerotier账号" tabindex="-1"><a class="header-anchor" href="#注册zerotier账号"><span>注册ZeroTier账号</span></a></h1><p>进入ZeroTier官网，注册账号 https://www.zerotier.com/</p><p>创建网络</p><p><img src="https://imgoss.xgss.net/picgo/image-20231123174454849.png?aliyun" alt="image-20231123174454849"></p><p>点击：create a network</p><p><img src="https://imgoss.xgss.net/picgo/image-20231123175043351.png?aliyun" alt="image-20231123175043351"></p><h1 id="群晖nas中配置zerotier" tabindex="-1"><a class="header-anchor" href="#群晖nas中配置zerotier"><span>群晖Nas中配置ZeroTier</span></a></h1><p>群晖DSM6.X下载相关套件安装以后要加入网络然后授权即可，DSM7.0以上可以使用第三方套件或者docker，这里我们使用官方推荐的docker方式。</p><h2 id="创建目录zerotier" tabindex="-1"><a class="header-anchor" href="#创建目录zerotier"><span>创建目录ZeroTier</span></a></h2><p>登录群辉，打开File Station，在docker目录下新建文件夹并重命名为ZeroTier，然后赋予读写权限。</p><p><img src="https://imgoss.xgss.net/picgo/image-20231123194007723.png?aliyun" alt="image-20231123194007723"></p><h2 id="拉取镜像" tabindex="-1"><a class="header-anchor" href="#拉取镜像"><span>拉取镜像</span></a></h2><p>由于我的docker镜像注册表失败，本文用ssh登录操作，不在nas的docker操作。</p><p>如果没有的话请在套件中心进行下载→注册表→搜索 zerotier-synology 双击选择最新版本下载</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>root@star-nas:~# docker pull zerotier/zerotier-synology</span></span>
<span class="line"><span>Using default tag: latest</span></span>
<span class="line"><span>latest: Pulling from zerotier/zerotier-synology</span></span>
<span class="line"><span>63b65145d645: Pull complete </span></span>
<span class="line"><span>fb097512307f: Pull complete </span></span>
<span class="line"><span>fb0fa1a4a4a5: Pull complete </span></span>
<span class="line"><span>646d6766cba7: Pull complete </span></span>
<span class="line"><span>f49b23d91910: Pull complete </span></span>
<span class="line"><span>87ef921da0c2: Pull complete </span></span>
<span class="line"><span>Digest: sha256:9adf1cb6e8b0ca8f80d28d2a7c4cfa18d102552a13a7f6f1b7923d75da408a07</span></span>
<span class="line"><span>Status: Downloaded newer image for zerotier/zerotier-synology:latest</span></span>
<span class="line"><span>docker.io/zerotier/zerotier-synology:latest</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="https://imgoss.xgss.net/picgo/image-20231124093751745.png?aliyun" alt="image-20231124093751745"></p><h2 id="创建一个持久的-tun" tabindex="-1"><a class="header-anchor" href="#创建一个持久的-tun"><span>创建一个持久的 TUN</span></a></h2><p>参考： https://docs.zerotier.com/synology/</p><p>使用vi工具编写脚本到路径: /usr/local/etc/rc.d/tun.sh 这将使得 /dev/net/tun 在启动时调用</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span># echo -e &#39;#!/bin/sh&#39; &gt;&gt; /usr/local/etc/rc.d/tun.sh</span></span>
<span class="line"><span># echo -e &#39;insmod /lib/modules/tun.ko&#39; &gt; /usr/local/etc/rc.d/tun.sh</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>给这段脚本添加权限（其实应该先vi这个空的脚本，然后添加权限，最后在写入上面的脚本内容，不然会提示你readonly）</span></span>
<span class="line"><span># chmod a+x /usr/local/etc/rc.d/tun.sh</span></span>
<span class="line"><span>运行脚本：</span></span>
<span class="line"><span># /usr/local/etc/rc.d/tun.sh</span></span>
<span class="line"><span></span></span>
<span class="line"><span>检查TUN的运行状态（可选）：</span></span>
<span class="line"><span># ls /dev/net/tun</span></span>
<span class="line"><span>/dev/net/tun</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="启动镜像" tabindex="-1"><a class="header-anchor" href="#启动镜像"><span>启动镜像</span></a></h2><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span># docker run -d \\</span></span>
<span class="line"><span>--name zerotier \\</span></span>
<span class="line"><span>--restart=always \\</span></span>
<span class="line"><span>--net=host \\</span></span>
<span class="line"><span>--device=/dev/net/tun \\</span></span>
<span class="line"><span>--cap-add=NET_ADMIN \\</span></span>
<span class="line"><span>--cap-add=SYS_ADMIN \\</span></span>
<span class="line"><span>-v /volume1/docker/ZeroTier:/var/lib/zerotier-one \\</span></span>
<span class="line"><span>zerotier/zerotier-synology</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="加入网络" tabindex="-1"><a class="header-anchor" href="#加入网络"><span>加入网络</span></a></h2><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>命令： docker exec -it &lt;docker容器的名字&gt; zerotier-cli join &lt;替换zerotier的网络ID&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span># docker exec -it zerotier zerotier-cli join 123456789</span></span>
<span class="line"><span>200 join OK</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="https://imgoss.xgss.net/picgo/image-20231124104652623.png?aliyun" alt="image-20231124104652623"></p><p>如果不是200 join ok，择要看看你的docker日志</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span># docker logs zerotier</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="常用命令" tabindex="-1"><a class="header-anchor" href="#常用命令"><span>常用命令</span></a></h2><p>在 ZeroTier 后台授权当前设备，然后查看状态：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span># docker exec -it zerotier zerotier-cli listnetworks</span></span>
<span class="line"><span>200 listnetworks &lt;nwid&gt; &lt;name&gt; &lt;mac&gt; &lt;status&gt; &lt;type&gt; &lt;dev&gt; &lt;ZT assigned ips&gt;</span></span>
<span class="line"><span>200 listnetworks 1c33c1ced0cfbfc5  c6:c3:ed:5e:04:17 ACCESS_DENIED PRIVATE zt2lrq44iv -</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h1 id="zerotier官网网络授权" tabindex="-1"><a class="header-anchor" href="#zerotier官网网络授权"><span>zerotier官网网络授权</span></a></h1><p>zerotier 官网，登录以后进入配置界面，在页面最下面对已经出现的设备进行授权，授权的方式为在□中打上√，取消打√即为取消授权。（如果没出现请稍等几秒之后刷新界面）</p><p><img src="https://imgoss.xgss.net/picgo/image-20231124103928771.png?aliyun" alt="image-20231124103928771"></p><p>在 Auth这里打钩</p><p><img src="https://imgoss.xgss.net/picgo/image-20231124104036709.png?aliyun" alt="image-20231124104036709"></p><h1 id="客户端安装" tabindex="-1"><a class="header-anchor" href="#客户端安装"><span>客户端安装</span></a></h1><p>ZeroTier客户端支持 苹果IOS，苹果MAC，安卓，微软的Windows和linux等常用的系统，本文只介绍Windows和安卓</p><h2 id="windows系统" tabindex="-1"><a class="header-anchor" href="#windows系统"><span>Windows系统</span></a></h2><h3 id="_1-下载windows软件" tabindex="-1"><a class="header-anchor" href="#_1-下载windows软件"><span>1.下载Windows软件</span></a></h3><p>去官网下载：https://www.zerotier.com/download/</p><p><img src="https://imgoss.xgss.net/picgo/image-20231124102330369.png?aliyun" alt="image-20231124102330369"></p><h3 id="_2-输入网络id" tabindex="-1"><a class="header-anchor" href="#_2-输入网络id"><span>2.输入网络ID</span></a></h3><p>安装之后，在电脑右下角输入Network ID</p><p><img src="https://imgoss.xgss.net/picgo/image-20231124102522297.png?aliyun" alt="image-20231124102522297"></p><p>Windows系统的ip是：</p><p><img src="https://imgoss.xgss.net/picgo/image-20231124105342063.png?aliyun" alt="image-20231124105342063"></p><h3 id="_3-测试访问nas" tabindex="-1"><a class="header-anchor" href="#_3-测试访问nas"><span>3.测试访问NAS</span></a></h3><p>如图访问成功，则说明zerotier组成的VPN网络成功。</p><p><img src="https://imgoss.xgss.net/picgo/image-20231124103358912.png?aliyun" alt="image-20231124103358912"></p><h2 id="安卓系统" tabindex="-1"><a class="header-anchor" href="#安卓系统"><span>安卓系统</span></a></h2><h3 id="_1-安装zerotier的手机app" tabindex="-1"><a class="header-anchor" href="#_1-安装zerotier的手机app"><span>1.安装ZeroTier的手机APP</span></a></h3><p><img src="https://imgoss.xgss.net/picgo/image-20231124111017541.png?aliyun" alt="image-20231124111017541"></p><h3 id="_2-添加网络" tabindex="-1"><a class="header-anchor" href="#_2-添加网络"><span>2.添加网络</span></a></h3><p><img src="https://imgoss.xgss.net/picgo/image-20231124111057862.png?aliyun" alt="image-20231124111057862"></p><h3 id="_3-填写网络id" tabindex="-1"><a class="header-anchor" href="#_3-填写网络id"><span>3.填写网络ID</span></a></h3><p><img src="https://imgoss.xgss.net/picgo/image-20231124111125012.png?aliyun" alt="image-20231124111125012"></p><h3 id="_4-测试访问nas" tabindex="-1"><a class="header-anchor" href="#_4-测试访问nas"><span>4.测试访问Nas</span></a></h3><p><img src="https://imgoss.xgss.net/picgo/image-20231124111143526.png?aliyun" alt="image-20231124111143526"></p><h1 id="总结" tabindex="-1"><a class="header-anchor" href="#总结"><span>总结</span></a></h1><p>其实没有公网IP的情况下，内网穿透的方案很多。比如还有FRP、NPS等，但是需要用到代理服务器</p><p>也可以选择像零遁NAS伴侣，蒲公英X1盒子，或者花生壳盒子这样专业的内网穿透硬件</p><p>所以今天介绍的这款ZeroTier就是给不想花钱，并且喜欢折腾的小伙伴准备的。它支持的平台多，一次搭建后期无脑使用，可谓是一劳永逸，虽说速度并不能完全保证（我这边是时快时慢），但是它完全可以作为无公网IP实现内网穿透的备用方案。</p>`,81)]))}const c=a(r,[["render",l]]),o=JSON.parse('{"path":"/article/07k1evvv/","title":"群晖NAS配置之ZeroTier实现内网穿透","lang":"en-US","frontmatter":{"title":"群晖NAS配置之ZeroTier实现内网穿透","createTime":"2025/05/27 17:51:17","permalink":"/article/07k1evvv/"},"git":{"createdTime":1749111496000,"updatedTime":1750129445000,"contributors":[{"name":"star","username":"star","email":"star@xgss.net","commits":2,"url":"https://github.com/star"}]},"readingTime":{"minutes":4.95,"words":1485},"filePathRelative":"NAS/群晖NAS配置之ZeroTier实现内网穿透.md"}');export{c as comp,o as data};
