import{_ as n}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as a,a as e,o as i}from"./app-BiQR_lPj.js";const l={};function r(d,s){return i(),a("div",null,s[0]||(s[0]=[e(`<h1 id="在释放一个数亿记录的表时报该错" tabindex="-1"><a class="header-anchor" href="#在释放一个数亿记录的表时报该错"><span>在释放一个数亿记录的表时报该错</span></a></h1><h2 id="阿里云rds删除数据库过期报错" tabindex="-1"><a class="header-anchor" href="#阿里云rds删除数据库过期报错"><span>阿里云RDS删除数据库过期报错：</span></a></h2><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>...</span></span>
<span class="line"><span>error	Creating index &#39;PRIMARY&#39; required more than &#39;innodb_online_alter_log_max_size&#39; bytes of modification log. Please try again.</span></span>
<span class="line"><span>optimize	status	Operation failed</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>网上搜索问题</p><p>https://blog.csdn.net/hyzx_9987/article/details/112010324 在释放一个数亿记录的表时报该错 Creating index &#39;PRIMARY&#39; required more than &#39;innodb_online_alter_log_max_size&#39; bytes of modification</p><p>最大的在线创建索引修改日志文件大小</p><p>大致意思就是，当online_alter的时候，会将insert,update,delete的数据存在log中，log有个上限就是这个参数；如果alter花费了1小时，而在这1小时内的数据变更超过500M，那么就会失败；</p><h2 id="解决方案" tabindex="-1"><a class="header-anchor" href="#解决方案"><span>解决方案</span></a></h2><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>set global innodb_online_alter_log_max_size = 10737418240，调大该值；</span></span>
<span class="line"><span></span></span>
<span class="line"><span>mysql&gt; show variables like &#39;%innodb_online_alter_log_max_size%&#39;;</span></span>
<span class="line"><span>+----------------------------------+-----------+</span></span>
<span class="line"><span>| Variable_name                    | Value     |</span></span>
<span class="line"><span>+----------------------------------+-----------+</span></span>
<span class="line"><span>| innodb_online_alter_log_max_size | 134217728 |</span></span>
<span class="line"><span>+----------------------------------+-----------+</span></span>
<span class="line"><span>1 row in set</span></span>
<span class="line"><span>默认大小为128M</span></span>
<span class="line"><span></span></span>
<span class="line"><span>set global innodb_online_alter_log_max_size=1073741824;</span></span>
<span class="line"><span>设置为1024G</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="在阿里云rds中用命令行修改" tabindex="-1"><a class="header-anchor" href="#在阿里云rds中用命令行修改"><span>在阿里云RDS中用命令行修改</span></a></h2><p>无权限</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>mysql&gt; set global innodb_online_alter_log_max_size=1073741824;</span></span>
<span class="line"><span>1227 - Access denied; you need (at least one of) the SUPER privilege(s) for this operation</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>阿里云后台的&#39;参数设置&#39;修改提交，之后即可生效（非重启数据库）。</p><p><img src="https://imgoss.xgss.net/picgo/image-20220510154650487.png?aliyun" alt="image-20220510154650487"></p><p>修成功</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>mysql&gt; show variables like &#39;%innodb_online_alter_log_max_size%&#39;;</span></span>
<span class="line"><span>+----------------------------------+------------+</span></span>
<span class="line"><span>| Variable_name                    | Value      |</span></span>
<span class="line"><span>+----------------------------------+------------+</span></span>
<span class="line"><span>| innodb_online_alter_log_max_size | 1073741824 |</span></span>
<span class="line"><span>+----------------------------------+------------+</span></span>
<span class="line"><span>1 row in set</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,16)]))}const o=n(l,[["render",r]]),c=JSON.parse('{"path":"/article/a9ksvlw3/","title":"innodb_online_alter_log_max_size","lang":"en-US","frontmatter":{"title":"innodb_online_alter_log_max_size","createTime":"2025/05/27 17:51:17","permalink":"/article/a9ksvlw3/"},"git":{"createdTime":1749111496000,"updatedTime":1750129445000,"contributors":[{"name":"star","username":"star","email":"star@xgss.net","commits":2,"url":"https://github.com/star"}]},"readingTime":{"minutes":0.98,"words":294},"filePathRelative":"debug/innodb_online_alter_log_max_size.md"}');export{o as comp,c as data};
